#!/bin/bash
# 2008-04-16 Chris Dumont. 
# fai-server:/data/fai/config/scripts/WEBGOAT/50-java. This script creates
# a script on the target disk which runs only on the *very first* boot after
# installation.


if [ "$target" = "" ]; then
  target="/"
fi

rm -f $target/root/java-bash
rm -f $target/etc/rc2.d/S80java-bash

cat <<EOF > $target/root/java-bash
#!/bin/bash
# 2007-04-16 Chris Dumont. target:/root/java-bash. This script is runs
# only on the *very first* boot after installation. This script is
# generated by fai-server:/data/fai/config/scripts/OMNI/50-java

set -e

/usr/sbin/update-java-alternatives -s java-6-sun
rm -f /etc/rc2.d/S80java-bash
rm -f /root/java-bash
touch /root/java-alternative_success

EOF

chmod +x $target/root/java-bash
ln -s /root/java-bash $target/etc/rc2.d/S80java-bash # Careful! chrooted.

