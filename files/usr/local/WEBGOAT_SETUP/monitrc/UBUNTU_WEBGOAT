set daemon 30            # check services at 2-minute intervals
set logfile /var/log/monit.log
set idfile /var/lib/monit/id
set statefile /var/lib/monit/state
set eventqueue
basedir /var/lib/monit/events # set the base directory where events will be stored
slots 100                     # optionally limit the queue size
#include /etc/monit/conf.d/*

set httpd port 2812
#set alert yingw@ece.ubc.ca
#set mailserver 127.0.0.1 

set httpd port 2812 and
  allow 142.103.0.0/16 	  # allow localhost to connect to the server and
  allow 137.82.0.0/16 	  # allow localhost to connect to the server and
  allow root:fd76af8s     # user 'admin' with password 'monit'

  #use address localhost	  # and only accept connection from localhost

check process tomcat7
        with pidfile /var/run/tomcat7.pid
        start "/etc/init.d/tomcat7 start"
        stop  "/etc/init.d/tomcat7 stop"
	if failed port 80 type tcp protocol http
		with timeout 15 seconds
		then restart
        if 3 restarts within 10 cycles then timeout
        group tomcat7

