# 2010-03-11 Chris Dumont. Suits many situations.
#
#  Configuration file for ferm(1).
#

table filter {
    chain INPUT {
        policy DROP;

        # connection tracking
        mod state state INVALID DROP;
        mod state state (ESTABLISHED RELATED) ACCEPT;

        # allow local packages
        interface lo ACCEPT;

        # respond to ping
        proto icmp ACCEPT; 
	
	# cfengine: input chain special rules go here.

	# ECE monitoring and control.
	proto tcp saddr scow.ece.ubc.ca dport munin    ACCEPT;
	proto udp saddr fee.iun.ubc.ca 	dport snmp     ACCEPT;
	proto tcp saddr huey.ece.ubc.ca dport cfengine ACCEPT; 

        # allow SSH connections
        proto tcp dport ssh ACCEPT;

    }
    chain OUTPUT {
        policy ACCEPT;

        # connection tracking
        #mod state state INVALID DROP;
        mod state state (ESTABLISHED RELATED) ACCEPT;
	
	# cfengine: output chain special rules go here.

    }
    chain FORWARD {
        policy DROP;

        # connection tracking
        mod state state INVALID DROP;
        mod state state (ESTABLISHED RELATED) ACCEPT;
	
	# cfengine: forward chain special rules go here.

    }
}

# IPv6:
#domain ip6 {
#    table filter {
#        chain INPUT {
#            policy ACCEPT;
#            # ...
#        }
#        # ...
#    }
#}
