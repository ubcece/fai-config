#
# Chris Dumont 2007-02-18 An example for /etc/monit/monitrc. For those that
# don't know monit is a daemon that can watch things (daemons, mounts, files
# and more) and take actions. In our case if tomcat crashes it will restart (but
# doesn't idiotically keep doing that forever). 

set logfile syslog facility log_daemon
set httpd port 2812
set alert chrisd@ece.ubc.ca

set httpd port 2812 and
  use address localhost # and only accept connection from localhost
  allow localhost       # allow localhost to connect to the server and
  allow root:blahblah     # user 'admin' with password 'monit'

check process tomcat55
	with pidfile /var/run/tomcat5.5.pid
	start "/etc/init.d/tomcat5.5 restart"
	stop  "/etc/init.d/tomcat5.5 stop"
	if 2 restarts within 3 cycles then timeout
	group nogroup
	
