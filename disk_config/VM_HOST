# 2010-11-07 Derek Poon <derekp@ece.ubc.ca>
# Volume groups are named "host" and "hostdata" rather than "vg" and "data"
# in case you want to manually loopback-mount a KVM guest's raw disk image
# using kpartx.  You don't want the guest and the host's volume group names
# to collide, as that would cause confusion.

# TODO: Consider potential filesystem block alignment issues:
# http://captainkvm.com/2011/09/revisiting-file-system-alignment-for-linux/
# http://askubuntu.com/questions/118140/unaligned-aio-dio

disk_config disk1 disklabel:gpt bootable:2 align-at:8k
primary  -             200M-300M   msdos        -
primary  swap          8G          swap         rw
primary  -             14G-60G     -            -
primary  /data         4G-6G       xfs          rw

disk_config lvm fstabkey:device
vg         host          disk1.3
host-root1 /             2G-18G      ext3         rw,errors=remount-ro
host-var1  /var          5G-12G      ext3         rw
host-root2 /altroot      2G-18G      ext3         rw,errors=remount-ro
host-var2  /altroot/var  5G-12G      ext3         rw

# setup-storage may complain of "disk too small" if partition 2.1 is set to
# 100%, probably due to failure to account for overhead.
disk_config disk2 disklabel:gpt preserve_lazy:2 align-at:8k
primary  -             200M-300M   msdos        -
primary  -             98%-        -            -

# If the /var/lib/vz filesystem is not ext[234] then disk quotas will not work
# in OpenVZ containers.  http://wiki.openvz.org/Disk_quota
disk_config lvm fstabkey:device preserve_lazy:hostdata-vz
vg        hostdata       disk2.2
hostdata-vz   /var/lib/vz  90%         ext4         rw,relatime,barrier=1,data=ordered
